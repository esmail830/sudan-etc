# ุญู ูุดููุฉ ุฎุทุฃ 403 ูู Supabase Auth - Sudan Electricity App

## ๐จ ุงููุดููุฉ
```
ุฎุทุฃ 403: ูุดููุฉ ูู ุงูุตูุงุญูุงุช (403). ุชุฃูุฏ ูู ุตุญุฉ ุงูุฑูุฒ ุฃู ุฌุฑุจ ูุฑุฉ ุฃุฎุฑู
```

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**
- ุฅุถุงูุฉ logging ููุตู ูุฌููุน ุงูุนูููุงุช
- ูุนุงูุฌุฉ ุฎุงุตุฉ ูุฎุทุฃ 403
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ

### 2. **ุชูุณูู ุฑูู ุงููุงุชู ุชููุงุฆูุงู**
- ุฅุถุงูุฉ ุฏุงูุฉ `formatPhoneNumber`
- ุชูุณูู ุชููุงุฆู ูุฑูู ุงููุงุชู
- ุฏุนู ุชูุณููุงุช ูุฎุชููุฉ (0XXXXXXXXX, 249XXXXXXXXX, +249XXXXXXXXX)

### 3. **ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก**
- ุชุตููู ุงูุฃุฎุทุงุก ุญุณุจ ุงูููุน
- ุฑุณุงุฆู ุฎุทุฃ ูุฎุตุตุฉ
- ุฑููุฒ ุฎุทุฃ ูุงุถุญุฉ

## ๐ง ุงูููุฏ ุงููุญุณู

### **ุชูุณูู ุฑูู ุงููุงุชู:**
```dart
String formatPhoneNumber(String phone) {
  // ุฅุฒุงูุฉ ุงููุณุงูุงุช ูุงูุฑููุฒ
  phone = phone.replaceAll(RegExp(r'[\s\-\(\)]'), '');
  
  // ุฅุฐุง ูู ูุจุฏุฃ ุจู +ุ ุฃุถู ุฑูุฒ ุงูุณูุฏุงู
  if (!phone.startsWith('+')) {
    if (phone.startsWith('0')) {
      phone = '+249${phone.substring(1)}';
    } else if (phone.startsWith('249')) {
      phone = '+$phone';
    } else {
      phone = '+249$phone';
    }
  }
  
  return phone;
}
```

### **ูุนุงูุฌุฉ ุฎุทุฃ 403:**
```dart
if (e.toString().contains('403') || e.toString().contains('Forbidden')) {
  return {
    'success': false, 
    'message': 'ุฎุทุฃ ูู ุงูุตูุงุญูุงุช (403). ุชุฃูุฏ ูู ุตุญุฉ ุงูุฑูุฒ ุฃู ุฌุฑุจ ูุฑุฉ ุฃุฎุฑู',
    'error_code': '403',
    'details': e.toString(),
  };
}
```

## ๐ฑ ููููุฉ ุงูุงุณุชุฎุฏุงู

### **1. ุฅุฑุณุงู OTP:**
```dart
final authService = AuthService();
final result = await authService.sendOtp(phone: '0912345678');
// ุณูุชู ุชูุณูู ุงูุฑูู ุชููุงุฆูุงู ุฅูู: +249912345678
```

### **2. ุงูุชุญูู ูู OTP:**
```dart
final result = await authService.verifyOtp(
  phone: '0912345678',
  token: '123456',
);
```

### **3. ูุฑุงูุจุฉ Logs:**
```bash
# ุณุชุธูุฑ ุฑุณุงุฆู ูุซู:
[AuthService] ุฑูู ุงููุงุชู ุงูููุณู: +249912345678
[AuthService] ูุญุงููุฉ ุฅุฑุณุงู OTP ุฅูู: +249912345678
[AuthService] ุชู ุฅุฑุณุงู OTP ุจูุฌุงุญ
```

## ๐ ุฃุณุจุงุจ ุฎุทุฃ 403

### **1. ูุดููุฉ ูู ุฅุนุฏุงุฏุงุช Supabase:**
- ุนุฏู ุชูุนูู Phone Auth
- ูุดููุฉ ูู RLS Policies
- ุนุฏู ุฅุนุฏุงุฏ SMS Provider

### **2. ูุดููุฉ ูู ุงูููุฏ:**
- ุฎุทุฃ ูู URL ุฃู API Key
- ูุดููุฉ ูู ุชูุณูู ุฑูู ุงููุงุชู
- ูุดููุฉ ูู ุฅุนุฏุงุฏุงุช Auth

### **3. ูุดููุฉ ูู ุงูุดุจูุฉ:**
- ุญุธุฑ ูู Firewall
- ูุดููุฉ ูู DNS
- ูุดููุฉ ูู SSL

## โ ุฎุทูุงุช ุงูุญู

### **ุงูุฎุทูุฉ 1: ูุญุต Supabase Dashboard**
1. ุงุฐูุจ ุฅูู [supabase.com](https://supabase.com)
2. ุณุฌู ุฏุฎูู ุฅูู ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู Authentication > Settings
4. ุชุฃูุฏ ูู ุชูุนูู Phone Auth
5. ุชุญูู ูู ุฅุนุฏุงุฏุงุช SMS Provider

### **ุงูุฎุทูุฉ 2: ูุญุต RLS Policies**
```sql
-- ูู SQL Editor
SELECT * FROM pg_policies WHERE schemaname = 'auth';

-- ุฅูุดุงุก ุณูุงุณุงุช ุฌุฏูุฏุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ
CREATE POLICY "Enable phone auth" ON auth.users
    FOR INSERT WITH CHECK (true);
```

### **ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูููุฏ**
1. ุฃุถู logging ุฅุถุงูู
2. ุงุฎุชุจุฑ ูุน ุฃุฑูุงู ููุงุชู ูุฎุชููุฉ
3. ุชุญูู ูู Console logs

### **ุงูุฎุทูุฉ 4: ูุญุต ุงูุดุจูุฉ**
1. ุชุฃูุฏ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช
2. ุงุฎุชุจุฑ ูู ุดุจูุฉ ูุฎุชููุฉ
3. ุชุญูู ูู Firewall

## ๐งช ุงุฎุชุจุงุฑ ุงูุญู

### **1. ุงุฎุชุจุงุฑ ุฅุฑุณุงู OTP:**
```bash
flutter run
# ุฃุฏุฎู ุฑูู ูุงุชู: 0912345678
# ุชุฃูุฏ ูู ุนุฏู ุธููุฑ ุฎุทุฃ 403
# ุฑุงุฌุน logs ููุชุฃูุฏ ูู ุงูุชูุณูู
```

### **2. ุงุฎุชุจุงุฑ ุงูุชุญูู ูู OTP:**
```bash
# ุฃุฏุฎู ุฑูุฒ OTP ุงููุณุชูู
# ุชุฃูุฏ ูู ูุฌุงุญ ุงูุนูููุฉ
# ุฑุงุฌุน logs ููุชุฃูุฏ ูู ุงูุชูุณูู
```

### **3. ูุฑุงูุจุฉ Logs:**
```bash
# ุงุจุญุซ ุนู ุฑุณุงุฆู:
[AuthService] ุฑูู ุงููุงุชู ุงูููุณู: +249912345678
[AuthService] ูุญุงููุฉ ุฅุฑุณุงู OTP ุฅูู: +249912345678
[AuthService] ุชู ุฅุฑุณุงู OTP ุจูุฌุงุญ
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุฅุฐุง ุงุณุชูุฑ ุฎุทุฃ 403:**

#### 1. ูุญุต Supabase Status
- ุงุฐูุจ ุฅูู [status.supabase.com](https://status.supabase.com)
- ุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุฉ

#### 2. ูุญุต Project Settings
- ุชุฃูุฏ ูู ุฃู ุงููุดุฑูุน ูุดุท
- ุชุญูู ูู Billing Status

#### 3. ูุญุต API Keys
- ุชุฃูุฏ ูู ุตุญุฉ anon key
- ุชุญูู ูู service_role key

#### 4. ูุญุต Network
- ุงุฎุชุจุฑ ูู ุฌูุงุฒ ูุฎุชูู
- ุงุฎุชุจุฑ ูู ุดุจูุฉ ูุฎุชููุฉ

## ๐ ููุงุญุธุงุช ูููุฉ

- **ุฎุทุฃ 403 ูุนูู Forbidden**: ูุดููุฉ ูู ุงูุตูุงุญูุงุช
- **ุชุญูู ูู ุฅุนุฏุงุฏุงุช Supabase**: Phone Auth ูุฌุจ ุฃู ูููู ููุนู
- **ุชุญูู ูู RLS Policies**: ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ ูุตุญูุญุฉ
- **ุชุญูู ูู SMS Provider**: ูุฌุจ ุฃู ูููู ููุนุฏ ุจุดูู ุตุญูุญ
- **ุชุญูู ูู Network**: ูุฏ ุชููู ูุดููุฉ ูู ุงูุดุจูุฉ

## ๐ ุฅุฐุง ูู ูุนูู ุงูุญู

### **1. ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ**
- ุฃูุดุฆ ูุดุฑูุน Supabase ุฌุฏูุฏ
- ุงุฎุชุจุฑ ูุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ

### **2. ุงุณุชุฎุฏุงู Auth UI**
- ุงุณุชุฎุฏู Supabase Auth UI ุจุฏูุงู ูู ุงูููุฏ ุงููุฎุตุต
- ูุฏ ูุญู ุงููุดุงูู ุชููุงุฆูุงู

### **3. ุงูุชูุงุตู ูุน ุงูุฏุนู**
- ุงุฐูุจ ุฅูู [supabase.com/support](https://supabase.com/support)
- ุงุฑูุน ุชูุงุตูู ุงููุดููุฉ

## ๐ฏ ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ุงูุญููู ุงูุชุงููุฉ:
1. โ **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** - ุฑุณุงุฆู ูุงุถุญุฉ ููููุฏุฉ
2. โ **ุชูุณูู ุฑูู ุงููุงุชู** - ุชููุงุฆู ูุฏุนู ุชูุณููุงุช ูุฎุชููุฉ
3. โ **ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก** - ุชุตููู ูุฑููุฒ ูุงุถุญุฉ
4. โ **Logging ููุตู** - ุชุชุจุน ุฌููุน ุงูุนูููุงุช

ุงูุขู ูุฌุจ ุฃู ูุนูู Phone Auth ุจุดูู ุฃูุถู! ๐
